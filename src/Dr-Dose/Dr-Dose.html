<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/bootstrap/dist/css/bootstrap-theme.min.css">

<dom-module id="dr-dose">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <h2>[[name]]</h2>
    <p>UUID: [[uuid]]</p>

    <button on-click="Dose">Toggle light</button>
    <button on-click="waterPlant">Water plant</button> for <input type="text" name="seconds" value="[[watertime]]" placeholder="Time in seconds">
  </template>
  

  <script>
    // What does this create? 
    // We need to bind this with Grow.js...

    Polymer({

      is: 'dr-dose',

      properties: {
        name: {
          type: String,
          value: 'Dr. Dose'
        },
        description: {
          type: String,
          value: 'Dr. Dose will keep your pH balanced and your nutrients at optimal levels.'
        },
        ph_target: {
          type: Number,
          value: 6.1
        },
        ph_upperBound: {
          type: Number,
          value: 6.2
        },
        ph_lowerBound: {
          type: Number,
          value: 5.9
        },
        uuid: {
          type: String,
          value: ''
        }
      },

      toggleLight: function(e) {

      },

      waterPlant: function(e) {
        var req = new XMLHttpRequest();

        req.open('GET', '/waterpump/', true);

        req.onload = function(e) {
          if (req.readyState == 4 && req.status == 200) {
            if (req.status == 200) {
              var response = JSON.parse(req.responseText);
              statusNode.textContent = response.on ? 'ON' : 'OFF';
            } else { 
              console.log('Error'); 
            }
          }
        }
        req.send(null);
      }
    });
  </script>
</dom-module>
